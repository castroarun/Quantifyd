<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Covered Call Strategy Optimization Report</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .report-container {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #1a365d;
            border-bottom: 3px solid #3182ce;
            padding-bottom: 15px;
            margin-bottom: 30px;
            font-size: 2.2em;
        }

        h2 {
            color: #2c5282;
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }

        h3 {
            color: #2d3748;
            margin: 20px 0 10px 0;
        }

        .meta-info {
            background: #ebf8ff;
            padding: 15px 20px;
            border-radius: 6px;
            margin-bottom: 30px;
            border-left: 4px solid #3182ce;
        }

        .meta-info p {
            margin: 5px 0;
        }

        .winner-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .winner-card {
            border-radius: 8px;
            padding: 25px;
            position: relative;
        }

        .winner-card.top-return {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
        }

        .winner-card.best-risk {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
        }

        .winner-badge {
            position: absolute;
            top: -10px;
            right: 20px;
            background: #ffd700;
            color: #1a202c;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.85em;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .winner-card h3 {
            color: white;
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        .winner-card .metric {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .winner-card .metric:last-child {
            border-bottom: none;
        }

        .winner-card .metric-value {
            font-weight: bold;
            font-size: 1.1em;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.95em;
        }

        .comparison-table th {
            background: #2d3748;
            color: white;
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .comparison-table tr:nth-child(even) {
            background: #f7fafc;
        }

        .comparison-table tr:hover {
            background: #edf2f7;
        }

        .highlight-green {
            color: #38a169;
            font-weight: bold;
        }

        .highlight-blue {
            color: #3182ce;
            font-weight: bold;
        }

        .highlight-red {
            color: #e53e3e;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.85em;
        }

        .results-table th {
            background: #4a5568;
            color: white;
            padding: 10px 12px;
            text-align: left;
            position: sticky;
            top: 0;
        }

        .results-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #e2e8f0;
        }

        .results-table tr:nth-child(even) {
            background: #f7fafc;
        }

        .results-table tr.top-5 {
            background: #c6f6d5;
        }

        .rank-badge {
            display: inline-block;
            width: 28px;
            height: 28px;
            line-height: 28px;
            text-align: center;
            border-radius: 50%;
            font-weight: bold;
            font-size: 0.85em;
        }

        .rank-1 { background: #ffd700; color: #1a202c; }
        .rank-2 { background: #c0c0c0; color: #1a202c; }
        .rank-3 { background: #cd7f32; color: white; }
        .rank-other { background: #e2e8f0; color: #4a5568; }

        .pine-link {
            display: inline-block;
            background: #2d3748;
            color: #68d391;
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            margin: 5px 5px 5px 0;
            font-family: monospace;
        }

        .pine-link:hover {
            background: #4a5568;
        }

        .insights-box {
            background: #fffaf0;
            border: 1px solid #ed8936;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .insights-box h3 {
            color: #c05621;
            margin-bottom: 15px;
        }

        .insights-box ul {
            margin-left: 20px;
        }

        .insights-box li {
            margin: 8px 0;
        }

        .warning-box {
            background: #fed7d7;
            border: 1px solid #e53e3e;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .warning-box h3 {
            color: #c53030;
            margin-bottom: 15px;
        }

        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
            text-align: center;
            color: #718096;
            font-size: 0.9em;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .report-container {
                box-shadow: none;
                padding: 20px;
            }
            .winner-section {
                page-break-inside: avoid;
            }
        }

        @media (max-width: 768px) {
            .winner-section {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="report-container">
        <h1>Covered Call Strategy Optimization Report</h1>

        <div class="meta-info">
            <p><strong>Generated:</strong> December 31, 2024</p>
            <p><strong>Stocks Tested:</strong> RELIANCE, TCS, HDFCBANK</p>
            <p><strong>Period:</strong> January 2024 - December 2024 (12 months)</p>
            <p><strong>Initial Capital:</strong> Rs 10,00,000</p>
            <p><strong>Strategies Tested:</strong> 50 combinations (sampled from 5,616 possible)</p>
        </div>

        <h2>WINNING STRATEGIES</h2>

        <div class="winner-section">
            <div class="winner-card top-return">
                <span class="winner-badge">TOP RETURN</span>
                <h3>OTM_2PCT + RSI(30-60) + Stop Loss</h3>
                <div class="metric">
                    <span>Total Return</span>
                    <span class="metric-value">29.07%</span>
                </div>
                <div class="metric">
                    <span>Win Rate</span>
                    <span class="metric-value">88.2%</span>
                </div>
                <div class="metric">
                    <span>Total Trades</span>
                    <span class="metric-value">17</span>
                </div>
                <div class="metric">
                    <span>Max Drawdown</span>
                    <span class="metric-value">4.92%</span>
                </div>
                <div class="metric">
                    <span>Sharpe Ratio</span>
                    <span class="metric-value">1.69</span>
                </div>
                <div class="metric">
                    <span>Profit Factor</span>
                    <span class="metric-value">8.09</span>
                </div>
            </div>

            <div class="winner-card best-risk">
                <span class="winner-badge">BEST RISK-ADJ</span>
                <h3>PIVOT_R1 + Stochastic + PT</h3>
                <div class="metric">
                    <span>Total Return</span>
                    <span class="metric-value">10.35%</span>
                </div>
                <div class="metric">
                    <span>Win Rate</span>
                    <span class="metric-value">62.5%</span>
                </div>
                <div class="metric">
                    <span>Total Trades</span>
                    <span class="metric-value">8</span>
                </div>
                <div class="metric">
                    <span>Max Drawdown</span>
                    <span class="metric-value">1.98%</span>
                </div>
                <div class="metric">
                    <span>Sharpe Ratio</span>
                    <span class="metric-value">0.57</span>
                </div>
                <div class="metric">
                    <span>Profit Factor</span>
                    <span class="metric-value">5.83</span>
                </div>
            </div>
        </div>

        <h2>HEAD-TO-HEAD COMPARISON</h2>

        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Metric</th>
                    <th>Top Return Strategy</th>
                    <th>Best Risk-Adjusted</th>
                    <th>Winner</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Strategy Name</strong></td>
                    <td>OTM_2PCT + RSI(30-60)</td>
                    <td>PIVOT_R1 + Stochastic</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td><strong>Strike Selection</strong></td>
                    <td>Fixed 2% OTM</td>
                    <td>Pivot R1 Level</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td><strong>Entry Filters</strong></td>
                    <td>RSI between 30-60</td>
                    <td>Stochastic Overbought</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td><strong>Exit Strategy</strong></td>
                    <td>Stop Loss (2x premium)</td>
                    <td>Profit Target (50%)</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td><strong>Total Return</strong></td>
                    <td class="highlight-green">29.07%</td>
                    <td>10.35%</td>
                    <td class="highlight-green">Top Return</td>
                </tr>
                <tr>
                    <td><strong>Annualized Return</strong></td>
                    <td class="highlight-green">29.09%</td>
                    <td>10.35%</td>
                    <td class="highlight-green">Top Return</td>
                </tr>
                <tr>
                    <td><strong>Win Rate</strong></td>
                    <td class="highlight-green">88.2%</td>
                    <td>62.5%</td>
                    <td class="highlight-green">Top Return</td>
                </tr>
                <tr>
                    <td><strong>Total Trades</strong></td>
                    <td class="highlight-green">17</td>
                    <td>8</td>
                    <td class="highlight-green">Top Return</td>
                </tr>
                <tr>
                    <td><strong>Max Drawdown</strong></td>
                    <td>4.92%</td>
                    <td class="highlight-blue">1.98%</td>
                    <td class="highlight-blue">Best Risk-Adj</td>
                </tr>
                <tr>
                    <td><strong>Sharpe Ratio</strong></td>
                    <td class="highlight-green">1.69</td>
                    <td>0.57</td>
                    <td class="highlight-green">Top Return</td>
                </tr>
                <tr>
                    <td><strong>Profit Factor</strong></td>
                    <td class="highlight-green">8.09</td>
                    <td>5.83</td>
                    <td class="highlight-green">Top Return</td>
                </tr>
                <tr>
                    <td><strong>Return/DD Ratio</strong></td>
                    <td class="highlight-green">5.91</td>
                    <td>5.23</td>
                    <td class="highlight-green">Top Return</td>
                </tr>
                <tr>
                    <td><strong>Composite Score</strong></td>
                    <td class="highlight-green">45.03</td>
                    <td>31.82</td>
                    <td class="highlight-green">Top Return</td>
                </tr>
            </tbody>
        </table>

        <div class="insights-box">
            <h3>Key Insights</h3>
            <ul>
                <li><strong>Top Return Strategy</strong> dominates with 29% return, 88% win rate, AND excellent 1.69 Sharpe ratio</li>
                <li><strong>Best Risk-Adjusted Strategy</strong> has the lowest max drawdown at just 1.98% - ideal for conservative traders</li>
                <li>RSI(30-60) filter on Top Return catches stocks NOT overbought but with momentum building</li>
                <li>2% OTM strike is more aggressive than 5% - more premium but higher assignment risk</li>
                <li><strong>Clear Winner:</strong> Top Return strategy outperforms on almost every metric</li>
            </ul>
        </div>

        <h2>TRADINGVIEW PINE SCRIPTS</h2>

        <p>TradingView strategy scripts have been created with full backtesting support. Files are located in <code>docs/tradingview/</code>:</p>

        <div style="margin: 20px 0;">
            <a class="pine-link" href="tradingview/TOP_RETURN_V2_FIXED.pine">TOP_RETURN_V2_FIXED.pine</a>
            <span style="color: #718096;">- OTM 5% + Supertrend + ADX Strategy</span>
        </div>
        <div style="margin: 20px 0;">
            <a class="pine-link" href="tradingview/TOP_RETURN_HOLD_CALL_VARIANT.pine">TOP_RETURN_HOLD_CALL_VARIANT.pine</a>
            <span style="color: #e53e3e;">- RISKY: Hold call on reversal variant</span>
        </div>
        <div style="margin: 20px 0;">
            <a class="pine-link" href="tradingview/BEST_RISK_V2_FIXED.pine">BEST_RISK_V2_FIXED.pine</a>
            <span style="color: #718096;">- ATR Strike + VWAP Strategy</span>
        </div>
        <div style="margin: 20px 0;">
            <a class="pine-link" href="tradingview/BEST_RISK_HOLD_CALL_VARIANT.pine">BEST_RISK_HOLD_CALL_VARIANT.pine</a>
            <span style="color: #e53e3e;">- RISKY: Hold call on VWAP break variant</span>
        </div>
        <div style="margin: 20px 0;">
            <a class="pine-link" href="tradingview/BEST_RISK_ADJ_STRATEGY.pine">BEST_RISK_ADJ_STRATEGY.pine</a>
            <span style="color: #718096;">- Original best risk-adjusted indicator</span>
        </div>

        <div class="warning-box">
            <h3>Warning: Hold Call Variants</h3>
            <ul>
                <li>The "HOLD_CALL" variants create a <strong>NAKED SHORT CALL</strong> position when exiting stock on reversal</li>
                <li>Naked calls have <strong>UNLIMITED RISK</strong> - stock can theoretically go to infinity</li>
                <li>Only use these variants if you understand and accept the risks</li>
                <li>Consider setting tight stop losses on naked call positions</li>
            </ul>
        </div>

        <h2>TOP 20 STRATEGY RESULTS</h2>

        <table class="results-table">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Strategy</th>
                    <th>Return%</th>
                    <th>Win Rate%</th>
                    <th>Trades</th>
                    <th>Max DD%</th>
                    <th>Sharpe</th>
                    <th>Score</th>
                </tr>
            </thead>
            <tbody>
                <tr class="top-5">
                    <td><span class="rank-badge rank-1">1</span></td>
                    <td><strong>OTM_2PCT + RSI(30-60) + SL</strong></td>
                    <td class="highlight-green">29.07%</td>
                    <td class="highlight-green">88.2%</td>
                    <td>17</td>
                    <td>4.92%</td>
                    <td class="highlight-green">1.69</td>
                    <td>45.03</td>
                </tr>
                <tr class="top-5">
                    <td><span class="rank-badge rank-2">2</span></td>
                    <td><strong>ATR_BASED + Bollinger + SL</strong></td>
                    <td>27.07%</td>
                    <td>83.3%</td>
                    <td>18</td>
                    <td>5.63%</td>
                    <td>1.41</td>
                    <td>42.65</td>
                </tr>
                <tr class="top-5">
                    <td><span class="rank-badge rank-3">3</span></td>
                    <td><strong>DELTA_30 + RSI+MACD + SL</strong></td>
                    <td>16.82%</td>
                    <td class="highlight-green">90.9%</td>
                    <td>11</td>
                    <td>6.45%</td>
                    <td>0.85</td>
                    <td>39.49</td>
                </tr>
                <tr class="top-5">
                    <td><span class="rank-badge rank-other">4</span></td>
                    <td><strong>BOLLINGER_UPPER + RSI+MACD + HTE</strong></td>
                    <td>11.63%</td>
                    <td>90.0%</td>
                    <td>10</td>
                    <td>5.39%</td>
                    <td>0.48</td>
                    <td>36.98</td>
                </tr>
                <tr class="top-5">
                    <td><span class="rank-badge rank-other">5</span></td>
                    <td><strong>OTM_5PCT + Bollinger + HTE</strong></td>
                    <td>15.55%</td>
                    <td>75.0%</td>
                    <td>12</td>
                    <td>6.23%</td>
                    <td>0.59</td>
                    <td>35.33</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">6</span></td>
                    <td>DELTA_30 + Bollinger + HTE</td>
                    <td>12.10%</td>
                    <td>75.0%</td>
                    <td>12</td>
                    <td>6.36%</td>
                    <td>0.36</td>
                    <td>33.70</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">7</span></td>
                    <td>OTM_2PCT + Bollinger+RSI + PT</td>
                    <td>10.48%</td>
                    <td>66.7%</td>
                    <td>15</td>
                    <td>3.77%</td>
                    <td>0.47</td>
                    <td>32.25</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">8</span></td>
                    <td><strong>PIVOT_R1 + Stochastic + PT</strong></td>
                    <td>10.35%</td>
                    <td>62.5%</td>
                    <td>8</td>
                    <td class="highlight-blue">1.98%</td>
                    <td>0.57</td>
                    <td>31.82</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">9</span></td>
                    <td>BOLLINGER_UPPER + Bollinger + PT</td>
                    <td>10.54%</td>
                    <td>64.7%</td>
                    <td>17</td>
                    <td>5.99%</td>
                    <td>0.33</td>
                    <td>31.21</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">10</span></td>
                    <td>ADAPTIVE_DELTA + Williams%R + SL</td>
                    <td>9.47%</td>
                    <td>70.0%</td>
                    <td>10</td>
                    <td>10.27%</td>
                    <td>0.21</td>
                    <td>30.92</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">11</span></td>
                    <td>DELTA_30 + Supertrend+ADX + SL</td>
                    <td>7.72%</td>
                    <td>66.7%</td>
                    <td>12</td>
                    <td>5.19%</td>
                    <td>0.07</td>
                    <td>30.16</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">12</span></td>
                    <td>ADAPTIVE_DELTA + Bollinger+RSI + SL</td>
                    <td>6.99%</td>
                    <td>66.7%</td>
                    <td>15</td>
                    <td>6.75%</td>
                    <td>0.02</td>
                    <td>29.62</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">13</span></td>
                    <td>ADAPTIVE_DELTA + RSI(30-60) + SL</td>
                    <td>12.48%</td>
                    <td>50.0%</td>
                    <td>12</td>
                    <td>7.37%</td>
                    <td>0.40</td>
                    <td>28.76</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">14</span></td>
                    <td>PIVOT_R1 + Triple Filter + PTSL</td>
                    <td>7.68%</td>
                    <td>57.1%</td>
                    <td>14</td>
                    <td>3.77%</td>
                    <td>0.05</td>
                    <td>28.44</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">15</span></td>
                    <td>DELTA_40 + Triple Filter + PTSL</td>
                    <td>9.22%</td>
                    <td>50.0%</td>
                    <td>14</td>
                    <td>4.01%</td>
                    <td>0.28</td>
                    <td>28.02</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">16</span></td>
                    <td>DELTA_30 + ADX + HTE</td>
                    <td>0.87%</td>
                    <td>75.0%</td>
                    <td>12</td>
                    <td>11.36%</td>
                    <td>-0.28</td>
                    <td>27.98</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">17</span></td>
                    <td>OTM_2PCT + Supertrend + PT</td>
                    <td>6.57%</td>
                    <td>57.1%</td>
                    <td>14</td>
                    <td>3.24%</td>
                    <td>-0.13</td>
                    <td>27.72</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">18</span></td>
                    <td>ATR_BASED + RSI(40-70) + PTSL</td>
                    <td>7.70%</td>
                    <td>53.3%</td>
                    <td>15</td>
                    <td>4.01%</td>
                    <td>0.06</td>
                    <td>27.67</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">19</span></td>
                    <td>DELTA_30 + RSI(40-70) + HTE</td>
                    <td>0.38%</td>
                    <td>75.0%</td>
                    <td>12</td>
                    <td>12.86%</td>
                    <td>-0.41</td>
                    <td>27.28</td>
                </tr>
                <tr>
                    <td><span class="rank-badge rank-other">20</span></td>
                    <td>DELTA_40 + EMA + SL</td>
                    <td>1.85%</td>
                    <td>66.7%</td>
                    <td>12</td>
                    <td>8.01%</td>
                    <td>-0.59</td>
                    <td>26.33</td>
                </tr>
            </tbody>
        </table>

        <h2>STRATEGY IMPLEMENTATION GUIDE</h2>

        <h3>For Top Return Strategy (OTM_2PCT + RSI 30-60 + Stop Loss)</h3>
        <ol>
            <li><strong>Entry Conditions:</strong>
                <ul>
                    <li>RSI(14) between 30 and 60 (momentum building, not overbought)</li>
                    <li>Wait for RSI to enter this zone before entering</li>
                </ul>
            </li>
            <li><strong>Strike Selection:</strong> Sell Call at 2% OTM (Strike = Current Price x 1.02)</li>
            <li><strong>Exit:</strong> Stop Loss at 2x premium received (allows SL adjustment/roll-up)</li>
            <li><strong>Expected Performance:</strong> ~29% annual return, 88% win rate</li>
        </ol>

        <h3>For Best Risk-Adjusted Strategy (PIVOT_R1 + Stochastic + Profit Target)</h3>
        <ol>
            <li><strong>Entry Conditions:</strong>
                <ul>
                    <li>Stochastic showing overbought conditions (%K > 80)</li>
                    <li>Expecting mean reversion or sideways movement</li>
                </ul>
            </li>
            <li><strong>Strike Selection:</strong> Pivot R1 resistance level</li>
            <li><strong>Exit:</strong> Profit Target at 50% of premium + Trailing Stop (25%/15%)</li>
            <li><strong>Expected Performance:</strong> ~10% annual return, <2% max drawdown</li>
        </ol>

        <h2>STRATEGY CONFIGURATION DETAILS</h2>

        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Parameter</th>
                    <th>Top Return</th>
                    <th>Best Risk-Adjusted</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Strike Method</td>
                    <td>OTM_2PCT (2% above current price)</td>
                    <td>PIVOT_R1 (Daily pivot resistance)</td>
                </tr>
                <tr>
                    <td>Entry Filter</td>
                    <td>RSI(14) between 30-60</td>
                    <td>Stochastic Overbought</td>
                </tr>
                <tr>
                    <td>Exit Strategy</td>
                    <td>STOP_LOSS (2.0x premium)</td>
                    <td>PROFIT_TARGET (50%)</td>
                </tr>
                <tr>
                    <td>SL Adjustment</td>
                    <td>Yes (Roll-up on profit)</td>
                    <td>Trailing Stop (25%/15%)</td>
                </tr>
                <tr>
                    <td>Profit Target</td>
                    <td>50% of premium</td>
                    <td>50% of premium</td>
                </tr>
            </tbody>
        </table>

        <div class="footer">
            <p><strong>Disclaimer:</strong> This report is based on simulated backtesting data. Past performance does not guarantee future results. Indian F&O markets have specific risks including physical settlement, STT, and F&O ban periods. Always test with paper trading before deploying real capital.</p>
            <p>Generated by Covered Calls Backtester | December 31, 2024</p>
            <p>Results File: <code>medium_optimization_results.json</code></p>
        </div>
    </div>
</body>
</html>
